University: [ITMO University](https://itmo.ru/ru/)
Faculty: [FICT](https://fict.itmo.ru)
Course: [Cloud platforms as the basis of technology entrepreneurship](https://) ADD link
Year: 2025/2026
Group: U4225
Author: Meshcheryakova Tatiana Sergeevna
Lab: Lab1
Date of create: 25.11.2025
Date of finished: 25.11.2025

# Лабораторная работа №1 — Обзор Google Cloud и исследование основных сервисов

## Тема: Знакомство с GCP, IAM, сервисными аккаунтами и Compute Engine
**Цель работы:** Освоить базовые возможности облачной платформы Google Cloud Platform (GCP), включая управление идентификацией и доступом (IAM), создание виртуальных машин (Compute Engine) и взаимодействие с облачным хранилищем (Cloud Storage).
**Инструменты:** Google Cloud Console, Identity and Access Management (IAM), Service Accounts, Compute Engine, Google Cloud Storage, утилита gsutil (внутри VM).

## 1. Введение

В рамках данной лабораторной работы я получила практический опыт работы с основными компонентами GCP. Главной задачей было не просто создать и настроить облачные ресурсы, но и наглядно продемонстрировать работу системы безопасности GCP — **IAM (Identity and Access Management)**, проверив, как изменение ролей Service Account влияет на доступ к другим сервисам.

Я успешно создала Service Account, развернула виртуальную машину на Compute Engine, скопировала данные из Cloud Storage и, путем изменения прав, подтвердила принцип минимальных привилегий.

## 2. Получение доступа и начальная настройка

Я успешно заполнила Google форму и получил доступ к облачной платформе GCP.

* **Получение доступа:** Доступ к консоли GCP был предоставлен с необходимыми правами для создания ресурсов в рамках проекта.
* **Первое посещение консоли:** После входа я ознакомилась с общим видом консоли и подтвердила, что все необходимые API (IAM, Compute Engine) активированы.
    ![Скриншот 130.png — Обзорная страница Cloud Console](130.png)
    ![Скриншот 131.png — Успешное получение доступа и общая информация о проекте](131.png)

## 3. Создание Service Account

Первым шагом было создание Service Account (SA), который VM будет использовать для аутентификации в других сервисах GCP.

1.  **Навигация:** Я перешела во вкладку **"IAM & Admin"** $\rightarrow$ **"Service Accounts"**.
    ![Скриншот 134.jpg — Список Service Accounts и навигация](134.jpg)
2.  **Нейминг:** Я создала SA, используя требуемый шаблон: `tmescheryakova-sa-lab1`.
3.  **Назначение роли:** На втором этапе создания я назначила SA роль **`Storage Admin`**. Эта роль давала SA полные права на управление Cloud Storage, что было необходимо для успешного копирования файлов на Шаге 5.
    ![Скриншот 133.png — Назначение Service Account роли Storage Admin](133.png)

## 4. Создание виртуальной машины (Compute Engine)

Я создала минимальную VM, которая должна была работать от имени созданного Service Account.

1.  **Навигация:** Я перешела в раздел **"Compute Engine"** $\rightarrow$ **"VM instances"**.
    ![Скриншот 132.png — Страница создания VM Compute Engine](132.png)
2.  **Нейминг:** Я назвала VM по шаблону: `tmescheryakova-vm-lab1`.
3.  **Характеристики машины:**
    * **Machine type:** `e2-micro`.
    * **Availability:** Установлена галочка **"Run as a Spot VM"** (чтобы сэкономить на расходах).
    * **Region/Zone:** Я выбрала ближайшую рабочую зону us-central1 (Iowa)
4.  **Настройки доступа:** В разделе **"Identity and API access"** я привязала созданный SA (`tmescheryakova-sa-lab1`) к этой VM и установила **`Access Scopes`** на **`Allow full access to all Cloud APIs`** (для простоты), чтобы гарантировать, что SA может использовать свои назначенные права.
    ![Скриншот 135.jpg — Настройка безопасности и доступа API для VM](135.jpg)
5.  **Запуск:** VM была успешно создана и перешла в статус Running.
    ![Скриншот 136.jpg — Запущенная VM tmescheryakova-vm-lab1](136.jpg)

## 5. Копирование файлов из бакета через gsutil

Я подключилась к VM через SSH и использовала утилиту `gsutil` для выполнения операции, требующей прав `Storage Admin`.

1.  **Подключение:** Я нажала кнопку **"SSH"** на странице VM.
2.  **Создание папки:** Создала папку `lab_files` для копирования: `mkdir lab_files`.
3.  **Поиск бакета и копирование:**
    * Сначала я столкнулась с проблемой (см. Раздел 9), но после исправления команды скопировала все объекты из бакета `lab1-bucket-itmo` в локальную папку:
        ```bash
        gsutil cp gs://lab1-bucket-itmo/* ./lab_files/
        ```
    ![Скриншот 138.png — Успешное копирование файлов с использованием gsutil](138.png)
4.  **Проверка:** Я проверила наличие файлов на VM.
    ```bash
    ls -lah ./lab_files/
    ```
    ![Скриншот 139.png — Подтверждение загрузки файлов на VM с помощью ls -lah](139.png)

> **Вывод Шага 5:** Операция прошла успешно, что подтвердило, что Service Account с ролью **`Storage Admin`** имеет достаточные права для чтения (и копирования) объектов из Cloud Storage.

## 6. Смена роли Service Account и проверка доступа

На этом этапе я наглядно продемонстрировала, как работает система IAM и принцип минимальных привилегий.

1.  **Изменение роли:** Я вернулась в раздел **"IAM & Admin"** и для Service Account `tmescheryakova-sa-lab1` я:
    * Удалила роль **`Storage Admin`**.
    * Добавила роль **`Compute Viewer`** (Просмотрщик Compute Engine).
    ![Скриншот 2025-11-25_12-28-38.jpg — Навигация для управления разрешениями SA](2025-11-25_12-28-38.jpg)
    ![Скриншот 140.png — Окно редактирования доступа: установлена роль Compute Viewer](140.png)
2.  **Повторная попытка копирования:** Я вернулась в SSH-консоль VM и попыталась снова скопировать файлы:
    ```bash
    gsutil cp gs://lab1-bucket-itmo/* ./lab_files_denied/
    ```
3.  **Результат:** Команда немедленно завершилась ошибкой:
    ```bash
    AccessDeniedException: 403 Forbidden. Permission 'storage.objects.list' denied on resource...
    ```
    ![Скриншот 141.png — Ошибка доступа 403 Forbidden после смены роли на Compute Viewer](141.png)

> **Вывод Шага 6:** Смена роли с `Storage Admin` на `Compute Viewer` немедленно привела к потере прав на доступ к Cloud Storage, что доказывает, что **IAM является основным механизмом авторизации** для всех сервисов GCP, включая `gsutil`, работающий от имени SA.

## 7. Завершение работы и удаление ресурсов

Для предотвращения ненужных расходов я удалила все созданные ресурсы в обратном порядке.

1.  **Удаление VM:** В разделе Compute Engine я остановила, а затем удалила VM `tmescheryakova-vm-lab1`.
    ![Скриншот 142.png — Остановка VM](142.png)
    ![Скриншот 143.png — Подтверждение удаления VM](143.png)
2.  **Удаление Service Account:** Я удалила Service Account `tmescheryakova-sa-lab1`.
    ![Скриншот 144.jpg — Подтверждение удаления Service Account](144.jpg)

## 8. Результаты лабораторной работы

Все цели и требования лабораторной работы были успешно выполнены и задокументированы:

✅ Создан service account (`tmescheryakova-sa-lab1`) с ролью `Storage Admin`.
✅ Создана VM (`tmescheryakova-vm-lab1`) типа `e2-micro Spot VM`.
✅ Перемещены файлы через `gsutil` (Шаг 3).
✅ Проверено влияние IAM ролей (Шаг 6, ошибка 403).
✅ Ресурсы удалены (VM и SA).
✅ Подготовлен полный отчёт с подтверждающими скриншотами.


## 9. Трудности и решения

| Проблема | Причина | Решение |
| :--- | :--- | :--- |
| **Ошибка копирования `No URLs matched`** | Исходная команда `gsutil cp gs://.../file1.txt...` предполагала точные имена файлов (`file1.txt`, `file2.txt`), которых не оказалось в бакете `lab1-bucket-itmo`. | Я заменил жесткие имена файлов на подстановочный знак (`*`): `gsutil cp gs://lab1-bucket-itmo/* ./lab_files/`. Копирование прошло успешно. |
| **Ошибка `AccessDeniedException: 403...`** | Service Account `tmescheryakova-sa-lab1` был лишен роли `Storage Admin` и получил роль `Compute Viewer`. | **Это не проблема, а ожидаемый вывод лабораторной работы.** Это подтверждает, что после смены прав доступ к хранилищу был отозван. |
